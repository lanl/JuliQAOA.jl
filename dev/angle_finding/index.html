<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Angle Finding · JuliQAOA</title><meta name="title" content="Angle Finding · JuliQAOA"/><meta property="og:title" content="Angle Finding · JuliQAOA"/><meta property="twitter:title" content="Angle Finding · JuliQAOA"/><meta name="description" content="Documentation for JuliQAOA."/><meta property="og:description" content="Documentation for JuliQAOA."/><meta property="twitter:description" content="Documentation for JuliQAOA."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img class="docs-light-only" src="../assets/logo.jpeg" alt="JuliQAOA logo"/><img class="docs-dark-only" src="../assets/logo-dark.jpeg" alt="JuliQAOA logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">JuliQAOA</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../basics/">Basic Use</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../mixers/">Mixers</a></li><li><a class="tocitem" href="../cost_funcs/">Cost Functions</a></li><li><a class="tocitem" href="../eval/">Simulation</a></li><li class="is-active"><a class="tocitem" href>Angle Finding</a></li><li><a class="tocitem" href="../utils/">Utilities</a></li></ul></li><li><a class="tocitem" href="../examples/">Examples</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Manual</a></li><li class="is-active"><a href>Angle Finding</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Angle Finding</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/lanl/JuliQAOA.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/lanl/JuliQAOA.jl/blob/main/docs/src/angle_finding.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Angle-Finding"><a class="docs-heading-anchor" href="#Angle-Finding">Angle Finding</a><a id="Angle-Finding-1"></a><a class="docs-heading-anchor-permalink" href="#Angle-Finding" title="Permalink"></a></h1><p>JuliQAOA uses <a href="https://enzyme.mit.edu/julia/stable/">Enzyme.jl</a> to enable  <a href="https://en.wikipedia.org/wiki/Automatic_differentiation">automatic differentiation</a> (also  referred to as &quot;AD&quot; or &quot;autodiff&quot;). In short, AD allows for calculating the gradient of a function <code>f(x1, x2,...)</code> in the same time as a single evaluation of <code>f</code> with a (roughly)  constant overhead, regardless of how many parameters <code>f</code> depends on.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The first time you run any gradient-based function (e.g. <a href="#JuliQAOA.grad"><code>grad</code></a>) there will likely be a delay of a few seconds while Enzyme does some precomputation and caching.</p></div></div><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>The first time you run <a href="#JuliQAOA.grad"><code>grad</code></a> with a <code>General</code> mixer (including  <a href="../mixers/#JuliQAOA.mixer_clique-Tuple{Int64, Int64}"><code>mixer_clique</code></a> and <a href="../mixers/#JuliQAOA.mixer_ring-Tuple{Int64, Int64}"><code>mixer_ring</code></a>) you will likely get the warning:</p><pre><code class="language-julia-repl hljs">Warning: Using fallback BLAS replacements, performance may be degraded</code></pre><p>This is a known <a href="https://discourse.julialang.org/t/warning-linking-two-modules-of-different-target-triples-bcloader-start/93864/4">issue</a> with Enzyme, and should hopefully be addressed soon. It does not indicate any incorrect results, just that things are a bit slower than they need to be until some kinks between BLAS and Enzyme are worked out.</p></div></div><ul><li><a href="#JuliQAOA.find_angles_bh"><code>JuliQAOA.find_angles_bh</code></a></li><li><a href="#JuliQAOA.find_local_maximum"><code>JuliQAOA.find_local_maximum</code></a></li><li><a href="#JuliQAOA.find_local_minimum"><code>JuliQAOA.find_local_minimum</code></a></li><li><a href="#JuliQAOA.grad"><code>JuliQAOA.grad</code></a></li><li><a href="#JuliQAOA.grad!"><code>JuliQAOA.grad!</code></a></li><li><a href="#JuliQAOA.grover_th-Tuple{Any, Any}"><code>JuliQAOA.grover_th</code></a></li></ul><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JuliQAOA.grad" href="#JuliQAOA.grad"><code>JuliQAOA.grad</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">grad(angles, mixer, obj_vals)</code></pre><p>Calculate the gradient of <a href="../eval/#JuliQAOA.exp_value"><code>exp_value(angles, mixer, obj_vals)</code></a>.</p><p>Can be extended to incorporate non-standard initial state <span>$|\psi_0\rangle$</span> and observables in the same way as <a href="../eval/#JuliQAOA.exp_value"><code>exp_value</code></a>.</p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p><code>grad</code> does not currently work with <code>Grover</code> mixers. For unconstrained problems you can use the equivalent <code>mixer_x(n, 0:n)/2^n</code>, and for constrained problems you can use <code>N = binom(n,k); mixer_general(dicke_states(n,k), ones(N,N)/N)</code>. These will both five you correct results, but are slower than the <code>Grover</code> implementation.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lanl/JuliQAOA.jl/blob/1af17731fc002a21069f192c0d70bef6d2cc492c/src/angle_finding.jl#L6-L19">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JuliQAOA.grad!" href="#JuliQAOA.grad!"><code>JuliQAOA.grad!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">grad!(G, angles, mixer, obj_vals; flip_sign=false)</code></pre><p>Calculate the gradient of <a href="../eval/#JuliQAOA.exp_value"><code>exp_value(angles, mixer, obj_vals)</code></a>, storing the result in the vector <code>G</code>. </p><p>The optional argument <code>flip_sign</code> adds an overall minus sign to <code>G</code>, which can be necessary to switch between using <code>grad!</code> to identify angles which minimize or maximize <code>exp_value</code>.</p><p>Can be extended to incorporate non-standard initial state <span>$|\psi_0\rangle$</span> and observables in the same way as <a href="../eval/#JuliQAOA.exp_value"><code>exp_value</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lanl/JuliQAOA.jl/blob/1af17731fc002a21069f192c0d70bef6d2cc492c/src/angle_finding.jl#L33-L44">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JuliQAOA.find_local_minimum" href="#JuliQAOA.find_local_minimum"><code>JuliQAOA.find_local_minimum</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">find_local_minimum(angles, mixer, obj_vals)</code></pre><p>Find <span>$\{\beta_i,\gamma_i\}$</span> which minimize the <span>$H_C$</span> defined by <code>obj_vals</code>, beginning at <code>angles</code> and doing local search with  <a href="https://en.wikipedia.org/wiki/Broyden–Fletcher–Goldfarb–Shanno_algorithm"><code>BFGS</code></a>.</p><p>Angles are returned in the ranges <span>$\beta_i \in [0,T_{H_M}],~\gamma_i \in [0,T_{H_C}]$</span>, where the operator periods <span>$T$</span> are calculated with <a href="../utils/#JuliQAOA.get_operator_period-Tuple{Any}"><code>get_operator_period</code></a>.</p><p>Can be extended to incorporate non-standard initial state <span>$|\psi_0\rangle$</span> and observables in the same way as <a href="../eval/#JuliQAOA.exp_value"><code>exp_value</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lanl/JuliQAOA.jl/blob/1af17731fc002a21069f192c0d70bef6d2cc492c/src/angle_finding.jl#L58-L70">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JuliQAOA.find_local_maximum" href="#JuliQAOA.find_local_maximum"><code>JuliQAOA.find_local_maximum</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">find_local_maximum(angles, mixer, obj_vals)</code></pre><p>Find <span>$\{\beta_i,\gamma_i\}$</span> which maximize the <span>$H_C$</span> defined by <code>obj_vals</code>, beginning at <code>angles</code> and doing local search with  <a href="https://en.wikipedia.org/wiki/Broyden–Fletcher–Goldfarb–Shanno_algorithm"><code>BFGS</code></a>.</p><p>Angles are returned in the ranges <span>$\beta_i \in [0,T_{H_M}],~\gamma_i \in [0,T_{H_C}]$</span>, where the operator periods <span>$T$</span> are calculated with <a href="../utils/#JuliQAOA.get_operator_period-Tuple{Any}"><code>get_operator_period</code></a>.</p><p>Can be extended to incorporate non-standard initial state <span>$|\psi_0\rangle$</span> and observables in the same way as <a href="../eval/#JuliQAOA.exp_value"><code>exp_value</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lanl/JuliQAOA.jl/blob/1af17731fc002a21069f192c0d70bef6d2cc492c/src/angle_finding.jl#L85-L97">source</a></section></article><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>While many optimization packages, e.g.  <a href="https://docs.scipy.org/doc/scipy/reference/optimize.html"><code>scipy.optimize</code></a>,  <a href="https://julianlsolvers.github.io/Optim.jl/stable/"><code>Optim.jl</code></a>, only include  minimization, we explicitly include both minimization and maximization. This is because  the standard trick of flipping the sign of the objective function to switch between  maximization and minimization doesn&#39;t work quite as smoothly with QAOA, as adding a  minus sign in front of <span>$H_C$</span> messess up the phases. Specifically, the fact that</p><pre><code class="language-juli_repl hljs">exp_value(angles, mixer, obj_vals) != -exp_value(angles, mixer, -obj_vals)</code></pre><p>makes it so that <span>$\{\beta_i, \gamma_i\}$</span> which minimize a given QAOA do <em>not</em> maximize  that same QAOA under the replacement <span>$H_C \to -H_C$</span>. In order to avoid having to  clarify whether some angles are good for e.g. &quot;maximizing MaxCut&quot; or  &quot;minimizing -MaxCut&quot;, we provide separate implementations for maximization and  minimization which avoid this sign confusion.</p></div></div><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JuliQAOA.find_angles_bh" href="#JuliQAOA.find_angles_bh"><code>JuliQAOA.find_angles_bh</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">find_angles_bh(p, mixer, obj_vals; max=true, niter=100, file=nothing)</code></pre><p>Find good angles up for the QAOA defined by <code>mixer</code>, <code>obj_vals</code> up to <code>p</code> rounds.</p><p>Uses an iterative, round-by-round angle finding algorithm that combines angle extrapolation and <a href="https://github.com/gamatos/Basinhopping.jl">basinhopping</a> to find high quality angles  up to <code>p</code> rounds. See <a href="https://arxiv.org/pdf/2202.00648.pdf">this</a> paper, section &quot;Angle &amp;  Threshold Finding&quot; for more details.</p><p>Optional arguments:</p><ul><li><code>max=false</code>: determines whether the goal is to minimize or maximize <code>exp_value</code></li><li><code>niter=100</code>: determines the number of basinhopping iterations</li><li><code>file=nothing</code>: save the resulting angles and expectation values in a plain text <code>file</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lanl/JuliQAOA.jl/blob/1af17731fc002a21069f192c0d70bef6d2cc492c/src/angle_finding.jl#L167-L181">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JuliQAOA.grover_th-Tuple{Any, Any}" href="#JuliQAOA.grover_th-Tuple{Any, Any}"><code>JuliQAOA.grover_th</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">grover_th_ev(p, obj_vals; max=true)</code></pre><p>Returns the optimal expectation value for the Grover-Th QAOA variant introduced <a href="https://arxiv.org/pdf/2106.13860.pdf">here</a>. </p><p>Grover-Th represent a direct port of Grover&#39;s search algorithm in the QAOA context. In other  words, the output of this function represents the expectation value at <code>p</code> rounds that one could recover by simply doing unstructured search for optimal states (technically it&#39;s a bit  more complicated than this, see <a href="https://arxiv.org/pdf/2202.00648.pdf">here</a> for a more  precise characterization). This can serve as a nice benchmark for QAOA performance, that is, QAOA should at least be able to beat unstructured search.</p><p>Set <code>max=false</code> for minimization problems.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lanl/JuliQAOA.jl/blob/1af17731fc002a21069f192c0d70bef6d2cc492c/src/grover.jl#L55-L69">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../eval/">« Simulation</a><a class="docs-footer-nextpage" href="../utils/">Utilities »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.1.2 on <span class="colophon-date" title="Wednesday 15 November 2023 02:31">Wednesday 15 November 2023</span>. Using Julia version 1.6.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
